___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Gumstack",
  "categories": ["CHAT", "LEAD_GENERATION", "SALES"],
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,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"
  },
  "description": "1-click video calling for your customers from your website or app.",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "apiToken",
    "displayName": "API Token",
    "simpleValueType": true
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

// Enter your template code here.
const createQueue = require('createQueue');
const logToConsole = require('logToConsole');
const injectScript = require('injectScript');
const queryPermission = require('queryPermission');
const copyFromWindow = require('copyFromWindow');
const setInWindow = require('setInWindow');
const callInWindow = require('callInWindow');

const apiToken = data.apiToken;
const log = logToConsole;
const url = "https://w.gumstack.com/v1/widget.js";
let queue = null;

log('data =', data);

const loadGumstack = () => {
  let Gumstack = copyFromWindow('Gumstack');
  Gumstack("init", {"token":apiToken});
  if (queryPermission('inject_script', url)) {
    injectScript(url, onSuccess, onFailure);
  } else {
    data.gtmOnFailure();
  }
};

const onSuccess = () => {
  log('Gumstack: Script loaded successfully.');
  data.gtmOnSuccess();
};

const onFailure = () => {
  log('Gumstack: Script load failed.');
  data.gtmOnFailure();
};

const initGumstack = () => {
  setInWindow('Gumstack', function() {
    const callMethod = copyFromWindow('Gumstack.callMethod.apply');
    if (callMethod) {           
      callInWindow('Gumstack.callMethod.apply', null, arguments); 
    } else {       
      callInWindow('Gumstack.q.push', arguments);
    }
  });
  createQueue('Gumstack.q');
  loadGumstack();
};

initGumstack();


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "all"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://w.gumstack.com/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "Gumstack"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "Gumstack.q"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "Gumstack.callMethod.apply"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "Gumstack.q.push"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []
setup: ''


___NOTES___

Created on 6/1/2021, 9:45:04 AM


